"use strict";(self.webpackChunkgamysh=self.webpackChunkgamysh||[]).push([[625],{9483:function(e,n,l){l(7539),l(7283);var a=l(2791),r=l(184);n.Z=function(e){var n=e.icon,l=e.handleClick,t=(e.tooltip,(0,a.useRef)());return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("button",{type:"button",ref:t,ripple:"light",onClick:l,className:"flex justify-center items-center w-10 h-10 mx-2 hover:text-white hover:bg-indigo-600 active:bg-white active:text-indigo-600 rounded-md focus:outline-none shadow-lg text-indigo-600 bg-white",children:n})})}},1758:function(e,n,l){var a=l(885),r=l(2791),t=l(184);n.Z=function(e){var n=e.children,l=(0,r.useState)(!1),i=(0,a.Z)(l,2),s=i[0],o=i[1];return(0,t.jsx)("div",{onClick:function(){return o(!s)},className:"".concat(s?"":"w-full sm:max-w-200 md:max-w-250 lg:max-w-xs overflow-ellipsis overflow-hidden md:whitespace-nowrap"," text-base hover:text-blue-500 cursor-pointer px-2"),children:n})}},6601:function(e,n,l){var a=l(184);n.Z=function(e){var n=e.children;return(0,a.jsx)("tbody",{children:n})}},7915:function(e,n,l){var a=l(184);n.Z=function(e){var n=e.children;return(0,a.jsx)("td",{children:n})}},8636:function(e,n,l){var a=l(184);n.Z=function(e){var n=e.children;return(0,a.jsx)("thead",{className:"sticky top-0 border-b text-left bg-white z-30",children:n})}},8044:function(e,n,l){var a=l(184);n.Z=function(e){var n=e.children;return(0,a.jsx)("tr",{className:"border-b w-full",children:n})}},1815:function(e,n,l){var a=l(184);n.Z=function(e){var n=e.children;return(0,a.jsx)("table",{className:"table w-full",children:n})}},1250:function(e,n,l){var a=l(885),r=l(2791);n.Z=function(e){var n=e.action,l=e.time,t=(0,r.useState)(0),i=(0,a.Z)(t,2),s=i[0],o=i[1];return function(e){s&&clearTimeout(s),o(setTimeout((function(){n(e)}),l))}}},4756:function(e,n,l){l.r(n),l.d(n,{default:function(){return F}});var a=l(885),r=l(1413),t=l(2791),i=l(4068),s=l(8044),o=l(1815),d=l(7915),c=l(8636),u=l(6601),f=l(2982),m=l(1134),x=l(3359),h=l(2797),v=l(4695),p=l(2669),w=l(6030),j=l(5564),g=l(5218),b=l(1547),y=l(1758),Z=l(9483),N=l(4097),_=l(3375),k=l(1401),C=l(1250),S=l(184);var A=function(e){return h.Ry().shape({name:"update"===e?h.Z_().nullable(!0):h.Z_().required().min(3).max(15),password:"update"===e?h.Z_().nullable(!0):h.Z_().required().min(5).max(15),role_id:"update"===e?h.Z_().nullable(!0):h.Rx().required(),sls_mans:"update"===e?h.IX().of(h.Ry().shape({id:h.Rx().required()})):h.Z_().nullable(!0)})},E=function(e){var n,l,i,s=e.visible,o=e.setCloseModal,d=e.form,c=e.values,u=(0,w.v9)((function(e){return e.auth.token})),h=(0,m.cI)({resolver:(0,v.X)(A(d))}),E=h.handleSubmit,M=h.errors,D=h.setValue,T=(h.getValues,h.watch,h.register),U=h.control,F=h.reset,I=(0,m.Dq)({control:U,name:"sls_mans",keyName:"key"}),O=I.fields,R=I.append,H=I.remove,L=(I.update,(0,t.useState)()),z=(0,a.Z)(L,2),q=z[0],P=(z[1],(0,t.useState)([])),G=(0,a.Z)(P,2),W=G[0],V=G[1],X=(0,t.useState)([]),B=(0,a.Z)(X,2),Q=B[0],J=B[1];(0,t.useEffect)((function(){s&&"update"===d&&ee((0,j.U2)({url:"api/admin/get-clients-for-sls/".concat(c.id),token:u,action:function(e){var n,l,a;e.success?(V(null===(n=e.data)||void 0===n?void 0:n.not_included),J(null===(l=e.data)||void 0===l?void 0:l.not_included),D("sls_mans",null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.included)):g.Am.error("Unknown error")}}))}),[s]);var K=(0,t.useState)([]),Y=(0,a.Z)(K,2),$=(Y[0],Y[1]),ee=(0,w.I0)();(0,t.useEffect)((function(){ee((0,j.U2)({url:"api/user/get-firms",token:u,action:function(e){var n;e.success?$(null===(n=e.data.rows)||void 0===n?void 0:n.map((function(e){return{label:e.name,value:e.id}}))):g.Am.error("Unknown error")}}))}),[s]);var ne=(0,C.Z)({time:500,action:function(e){return V(Q.filter((function(n){return n.name.toLowerCase().includes(e.toLowerCase())})))}});return(0,S.jsx)(x.Z,{visible:s,setCloseModal:function(){o(),V([]),F({name:"",password:"",role_id:"",sls_mans:[]})},title:"Operator add",size:"update"===d?"lg":"",children:(0,S.jsxs)("form",{onSubmit:E((function(e){if("update"===d){var n,l=null===(n=e.sls_mans)||void 0===n?void 0:n.filter((function(e){return!e.usm_id}));l.length&&ee((0,j.v_)({url:"api/admin/add-clietns-to-sls/".concat(null===c||void 0===c?void 0:c.id),token:u,data:l,action:function(e){e.success?o():g.Am.error("Unknown error")}}))}"update"!==d&&ee((0,j.v_)({url:"api/admin/add-operator",token:u,data:e,action:function(e){e.success?(console.log("hello"),o()):g.Am.error("Some error")}}))})),className:"w-full pb-12 flex flex-col justify-center items-center",children:["add"===d?(0,S.jsx)(S.Fragment,{children:(0,S.jsxs)("div",{className:"w-full flex flex-col",children:[(0,S.jsxs)("div",{className:"relative w-full mb-6",children:[(0,S.jsx)("label",{children:"\u041f\u043e\u043b\u043d\u043e\u0435 \u0418\u043c\u044f"}),(0,S.jsx)("input",(0,r.Z)((0,r.Z)({type:"text"},T("name")),{},{autoComplete:"false",className:"".concat(null!==M&&void 0!==M&&M.name?"border-2 border-red-300 ring-red-100":"ring-indigo-600"," px-3 shadow-inner h-10 w-full text-base bg-gray-50 rounded-md z-20 focus:bg-white focus:outline-none focus:ring-2 "),placeholder:"\u043d\u0430\u043f\u0440. \u0414\u043e\u0432\u0440\u0430\u043d \u0414\u0436\u0443\u043c\u0430\u043a\u0443\u043b\u044b\u0435\u0432"})),(0,S.jsx)("p",{className:"absolute bottom-0 left-0 -mb-4 text-xs font-medium text-red-400",children:null===M||void 0===M||null===(n=M.name)||void 0===n?void 0:n.message})]}),(0,S.jsxs)("div",{className:"relative w-full mb-6",children:[(0,S.jsx)("label",{children:"password"}),(0,S.jsx)("input",(0,r.Z)((0,r.Z)({type:"password"},T("password")),{},{autoComplete:"false",className:"".concat(null!==M&&void 0!==M&&M.password?"border-2 border-red-300 ring-red-100":"ring-indigo-600"," px-3 shadow-inner h-10 w-full text-base bg-gray-50 rounded-md z-20 focus:bg-white focus:outline-none focus:ring-2 "),placeholder:"\u043d\u0430\u043f\u0440. \u0414\u043e\u0432\u0440\u0430\u043d \u0414\u0436\u0443\u043c\u0430\u043a\u0443\u043b\u044b\u0435\u0432"})),(0,S.jsx)("p",{className:"absolute bottom-0 left-0 -mb-4 text-xs font-medium text-red-400",children:null===M||void 0===M||null===(l=M.password)||void 0===l?void 0:l.message})]}),(0,S.jsx)("div",{className:"relative w-full mb-6",children:(0,S.jsx)(m.Qr,{control:U,name:"role_id",render:function(e){var n=e.field,l=n.onChange,a=n.value;return(0,S.jsx)(p.Ph,{label:"Select frim",onChange:l,value:a,data:[{label:"Supervisor",value:3},{label:"Moderator",value:2}],placeholder:"Birini saylan"})}})})]})}):(0,S.jsx)(S.Fragment,{children:(0,S.jsxs)("div",{className:"relative flex flex-row w-full mb-4 shadow-inner bg-gray-50 lg:h-96 lg:max-h-96 h-64 max-h-64 min-w-600",children:[(0,S.jsxs)("div",{className:"flex flex-col w-1/2",children:[(0,S.jsx)("div",{className:"w-full flex md:flex-row justify-center  lg:items-end my-2 px-2 rounded-md ",children:(0,S.jsx)("input",{className:"ring-indigo-600 px-3 shadow-inner h-10 w-full text-base bg-white rounded-md z-20 focus:bg-white focus:outline-none focus:ring-2",placeholder:"Search text",onChange:function(e){return ne(e.target.value)}})}),(0,S.jsx)("div",{className:"relative w-full flex flex-col justify-start items-start px-2 rounded-lg h-full  overflow-y-auto",children:null===W||void 0===W?void 0:W.map((function(e,n){return(0,S.jsxs)("div",{className:"".concat(n%2===0?"bg-green-100":"bg-yellow-100"," w-full rounded-lg my-2 px-2 py-1 flex flex-row justify-between items-center"),children:[(0,S.jsx)(y.Z,{children:e.name}),(0,S.jsx)(Z.Z,{handleClick:function(){R((0,r.Z)({},e)),V(W.filter((function(n){return+e.id!==+n.id})))},icon:(0,S.jsx)(k.D,{className:"text-2xl "})})]},n)}))})]}),(0,S.jsx)("div",{className:"w-1 h-full bg-blue-300 rounded"}),(0,S.jsx)("div",{className:"".concat(null!==M&&void 0!==M&&null!==(i=M.sales_mans)&&void 0!==i&&i.message?" border-red-300 ring-red-100 border-2":""," relative w-1/2 flex flex-col justify-start items-start px-2  rounded-lg h-full  overflow-y-auto"),children:O.map((function(e,n){return(0,S.jsxs)("div",{className:"".concat(n%2===0?"bg-green-100":"bg-yellow-100"," w-full flex flex-col md:flex-row justify-center  lg:items-end my-2 px-2 rounded-md "),children:[(0,S.jsx)("div",{className:"w-full flex justify-start items-center md:h-full",children:(0,S.jsx)(y.Z,{children:e.name})}),(0,S.jsx)("div",{className:"w-48 flex justify-center items-center mt-6 lg:mt-0",children:e.usm_id?(0,S.jsx)("div",{className:"w-full flex flex-row justify-between items-center",children:(0,S.jsx)(Z.Z,{handleClick:function(){!function(e,n){ee((0,j.v_)({url:"api/admin/delete-client-from-sls-man/".concat(e),token:u,action:function(e){e.success?H(n):g.Am.error("Unknown error")}}))}(e.usm_id,n),V([].concat((0,f.Z)(W),[{id:e.id,name:e.name}]))},icon:(0,S.jsx)(N.S,{className:"text-2xl"})})}):(0,S.jsx)("div",{className:"w-full flex flex-row justify-between items-center",children:(0,S.jsx)(Z.Z,{handleClick:function(){H(n)},icon:(0,S.jsx)(_.F,{className:"text-2xl "})})})})]},n)}))})]})}),(0,S.jsx)("button",{type:"submit",disabled:q,className:"w-40 flex remove-button-bg justify-center items-center px-4 h-15 text-white transform ease-in-out duration-300 hover:scale-110 active:scale-100 font-semibold text-base rounded-full bg-green-500 hover:bg-green-400 active:bg-green-500 focus:outline-none shadow-md",children:q?(0,S.jsx)("div",{className:"w-12 h-10 ",children:(0,S.jsx)(b.Z,{size:"sm"})}):(0,S.jsx)("div",{className:"h-10 flex justify-center items-center",children:"update"===d?"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"})})]})})},M=l(5071),D=l(1310).default;function T(e,n){switch(console.log(n),n.type){case"SET_DATA":return(0,r.Z)((0,r.Z)({},e),{},{data:n.payload.rows});case"OPEN_MODAL":return(0,r.Z)((0,r.Z)({},e),{},{visible:!0,form:"add"});case"ClOSE_MODAL":return(0,r.Z)((0,r.Z)({},e),{},{visible:!1});case"EDIT_MODAL":return(0,r.Z)((0,r.Z)({},e),{},{visible:!0,form:"update",values:n.payload});case"SET_FIRMS":return(0,r.Z)((0,r.Z)({},e),{},{firms:n.payload});case"SET_WHS":return(0,r.Z)((0,r.Z)({},e),{},{warehouses:n.payload});case"CHANGE_WH":return(0,r.Z)((0,r.Z)({},e),{},{data:e.data.map((function(e){var l,a;e.id==(null===n||void 0===n||null===(l=n.payload)||void 0===l?void 0:l.id)&&(console.log(e),e.wh_id=null===(a=n.payload)||void 0===a?void 0:a.value);return e}))});case"CHANGE_FIRM":return(0,r.Z)((0,r.Z)({},e),{},{data:e.data.map((function(e){var l,a;e.id==(null===n||void 0===n||null===(l=n.payload)||void 0===l?void 0:l.id)&&(console.log(e),e.firm_id=null===(a=n.payload)||void 0===a?void 0:a.value);return e}))});default:return(0,r.Z)({},e)}}var U=function(e){e.handleClick;return(0,S.jsx)("div",{className:"flex flex-row justify-between items-center",children:(0,S.jsx)("div",{className:"w-80"})})},F=function(){var e,n=(0,t.useReducer)(T,{data:[],loading:!1,visible:!1,values:{},warehouses:[]}),l=(0,a.Z)(n,2),r=l[0],f=l[1],m=(0,w.v9)((function(e){return e.auth.token})),x=(0,w.I0)();return(0,t.useEffect)((function(){x((0,j.U2)({url:"api/admin/get-sls-mans-for-mod",token:m,action:function(e){e.success?f({type:"SET_DATA",payload:e.data}):g.Am.error("Unknown error")}})),x((0,j.U2)({url:"api/user/get-firms",token:m,action:function(e){e.success&&f({type:"SET_FIRMS",payload:e.data.rows})}})),x((0,j.U2)({url:"api/admin/get-whs",token:m,action:function(e){e.success&&f({type:"SET_WHS",payload:e.data.rows})}}))}),[]),(0,S.jsxs)(D,{header:(0,S.jsx)(U,{handleClick:function(){return f({type:"OPEN_MODAL",payload:""})}}),children:[(0,S.jsx)(E,{visible:r.visible,setCloseModal:function(){return f({type:"ClOSE_MODAL",payload:""})},form:r.form,values:r.values}),r.loading?(0,S.jsx)(i.Z,{loading:r.loading}):(0,S.jsx)("div",{className:"w-full h-full px-6 py-6 overflow-y-auto",children:(0,S.jsxs)(o.Z,{children:[(0,S.jsx)(c.Z,{children:(0,S.jsx)(s.Z,{children:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(d.Z,{className:"px-2 py-4 font-medium flex flex-row justify-center items-center",children:(0,S.jsx)("span",{children:"ID"})}),(0,S.jsx)(d.Z,{className:"px-2 py-4 font-medium flex flex-row justify-center items-center",children:(0,S.jsx)("span",{children:"Name"})}),(0,S.jsx)(d.Z,{className:"px-2 py-4 w-4 font-medium flex flex-row justify-center items-center",children:(0,S.jsx)("span",{children:"Firm"})}),(0,S.jsx)(d.Z,{className:"px-2 py-4 font-medium flex flex-row justify-center items-center",children:(0,S.jsx)("span",{children:"Edit"})})]})})}),(0,S.jsx)(u.Z,{children:null===(e=r.data)||void 0===e?void 0:e.map((function(e){var n,l;return(0,S.jsx)(s.Z,{children:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(d.Z,{className:"p-2",children:e.id}),(0,S.jsx)(d.Z,{className:"p-2",children:e.name}),(0,S.jsx)(d.Z,{className:"p-2 w-4",children:(0,S.jsx)(p.Ph,{onChange:function(n){return function(e,n){x((0,j.v_)({url:"api/admin/change-sls-firm/".concat(e),token:m,data:{value:n},action:function(l){l.success?f({type:"CHANGE_FIRM",payload:{value:n,id:e}}):g.Am.error("Unknon error")}}))}(e.id,n)},data:null!==(n=r.firms)&&void 0!==n&&n.length?r.firms:[],value:e.firm_id})}),(0,S.jsx)(d.Z,{className:"p-2 w-max-4",children:(0,S.jsx)(p.Ph,{onChange:function(n){return function(e){var n=e.id,l=e.value;console.log(n,l),x((0,j.v_)({url:"api/admin/change-sls-wh/".concat(n),token:m,data:{value:l},action:function(e){e.success?f({type:"CHANGE_WH",payload:{value:l,id:n}}):g.Am.error("Unknon error")}}))}({id:e.id,value:n})},data:null!==(l=r.warehouses)&&void 0!==l&&l.length?e.firm_id?r.warehouses.filter((function(n){return e.firm_id===n.firm_id})):r.warehouses:[],value:e.wh_id})}),(0,S.jsx)(d.Z,{className:"p-2",children:(0,S.jsx)(Z.Z,{handleClick:function(){return f({type:"EDIT_MODAL",payload:e})},icon:(0,S.jsx)(M.H,{className:"text-2xl"})})})]})},e.id)}))})]})})]})}}}]);
//# sourceMappingURL=625.e19d8b2d.chunk.js.map